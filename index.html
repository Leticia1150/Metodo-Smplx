<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Optimizador Lineal Simplex</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #fdf6f0;
      color: #444;
      padding: 30px;
    }

    h1 {
      color: #d17b88;
    }

    .card {
      background: #ffffff;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      margin-bottom: 20px;
      max-width: 800px;
    }

    label, input, select {
      margin: 5px;
    }

    input {
      padding: 5px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    button {
      background: #d17b88;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }

    #grafica {
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <h1>Visualizador Simplex üìà</h1>

  <div class="card">
    <label>Tipo de optimizaci√≥n:</label>
    <select id="tipo">
      <option value="max">Maximizar</option>
      <option value="min">Minimizar</option>
    </select><br><br>

    <label>Funci√≥n objetivo Z = </label>
    <input type="number" id="z_x" placeholder="Coef x"> x +
    <input type="number" id="z_y" placeholder="Coef y"> y
    <br><br>

    <label>Restricci√≥n 1: </label>
    <input type="number" id="r1_x" placeholder="Coef x"> x +
    <input type="number" id="r1_y" placeholder="Coef y"> y ‚â§
    <input type="number" id="r1_b" placeholder="Valor">
    <br>

    <label>Restricci√≥n 2: </label>
    <input type="number" id="r2_x" placeholder="Coef x"> x +
    <input type="number" id="r2_y" placeholder="Coef y"> y ‚â§
    <input type="number" id="r2_b" placeholder="Valor">
    <br><br>

    <button onclick="graficar()">Graficar</button>
  </div>

  <div id="grafica"></div>

  <script>
    function graficar() {
      const tipo = document.getElementById('tipo').value;

      const z_x = parseFloat(document.getElementById('z_x').value);
      const z_y = parseFloat(document.getElementById('z_y').value);

      const r1_x = parseFloat(document.getElementById('r1_x').value);
      const r1_y = parseFloat(document.getElementById('r1_y').value);
      const r1_b = parseFloat(document.getElementById('r1_b').value);

      const r2_x = parseFloat(document.getElementById('r2_x').value);
      const r2_y = parseFloat(document.getElementById('r2_y').value);
      const r2_b = parseFloat(document.getElementById('r2_b').value);

      let puntos = [];

      for (let x = 0; x <= 30; x += 0.25) {
        for (let y = 0; y <= 30; y += 0.25) {
          if (
            r1_x * x + r1_y * y <= r1_b &&
            r2_x * x + r2_y * y <= r2_b &&
            x >= 0 && y >= 0
          ) {
            puntos.push({ x: x, y: y, z: z_x * x + z_y * y });
          }
        }
      }

      if (puntos.length === 0) {
        alert("No hay regi√≥n factible.");
        return;
      }

      let punto_optimo = tipo === "max"
        ? puntos.reduce((a, b) => a.z > b.z ? a : b)
        : puntos.reduce((a, b) => a.z < b.z ? a : b);

      // Eliminar duplicados por coordenadas para v√©rtices visibles
      let vertices = [];
      let added = new Set();
      for (let p of puntos) {
        let key = p.x.toFixed(2) + "," + p.y.toFixed(2);
        if (!added.has(key)) {
          added.add(key);
          vertices.push(p);
        }
      }

      let trace_factible = {
        x: puntos.map(p => p.x),
        y: puntos.map(p => p.y),
        mode: 'markers',
        type: 'scatter',
        name: 'Regi√≥n factible',
        marker: { color: '#AEDFF7', size: 3 }
      };

      let trace_vertices = {
        x: vertices.map(p => p.x),
        y: vertices.map(p => p.y),
        mode: 'text+markers',
        type: 'scatter',
        text: vertices.map(p => `(${p.x.toFixed(1)}, ${p.y.toFixed(1)})`),
        textposition: 'top center',
        name: 'V√©rtices',
        marker: { color: '#6666cc', size: 6 }
      };

      let trace_optimo = {
        x: [punto_optimo.x],
        y: [punto_optimo.y],
        mode: 'markers+text',
        type: 'scatter',
        text: [`Z √≥ptimo: ${punto_optimo.z.toFixed(2)}`],
        textposition: 'bottom center',
        name: '√ìptimo',
        marker: { color: '#ff66a3', size: 10, symbol: 'star' }
      };

      let layout = {
        title: 'Visualizaci√≥n gr√°fica de la soluci√≥n',
        xaxis: { title: 'x', range: [0, 20] },
        yaxis: { title: 'y', range: [0, 20] },
        plot_bgcolor: "#fcf3f0",
        paper_bgcolor: "#fefefe"
      };

      Plotly.newPlot('grafica', [trace_factible, trace_vertices, trace_optimo], layout);
    }
  </script>

</body>
</html>
