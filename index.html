<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Gráfico de Programación Lineal</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body { font-family: Arial; margin: 30px; }
    input { width: 80px; margin: 5px; }
    #grafica { width: 100%; height: 500px; }
  </style>
</head>
<body>

  <h2>Programación Lineal (Método gráfico - Simplex visual)</h2>

  <p>Función objetivo: Max Z = 
    <input type="number" id="z_x" placeholder="Coef x"> x + 
    <input type="number" id="z_y" placeholder="Coef y"> y
  </p>

  <p>Restricción 1: 
    <input type="number" id="r1_x" placeholder="Coef x"> x + 
    <input type="number" id="r1_y" placeholder="Coef y"> y ≤ 
    <input type="number" id="r1_b" placeholder="≤ valor">
  </p>

  <p>Restricción 2: 
    <input type="number" id="r2_x" placeholder="Coef x"> x + 
    <input type="number" id="r2_y" placeholder="Coef y"> y ≤ 
    <input type="number" id="r2_b" placeholder="≤ valor">
  </p>

  <button onclick="graficar()">Graficar solución</button>

  <div id="grafica"></div>

  <script>
    function graficar() {
      const z_x = parseFloat(document.getElementById('z_x').value);
      const z_y = parseFloat(document.getElementById('z_y').value);

      const r1_x = parseFloat(document.getElementById('r1_x').value);
      const r1_y = parseFloat(document.getElementById('r1_y').value);
      const r1_b = parseFloat(document.getElementById('r1_b').value);

      const r2_x = parseFloat(document.getElementById('r2_x').value);
      const r2_y = parseFloat(document.getElementById('r2_y').value);
      const r2_b = parseFloat(document.getElementById('r2_b').value);

      let puntos = [];

      for (let x = 0; x <= 50; x += 0.5) {
        for (let y = 0; y <= 50; y += 0.5) {
          if (
            r1_x * x + r1_y * y <= r1_b &&
            r2_x * x + r2_y * y <= r2_b &&
            x >= 0 && y >= 0
          ) {
            puntos.push({ x: x, y: y, z: z_x * x + z_y * y });
          }
        }
      }

      if (puntos.length === 0) {
        alert("No hay región factible.");
        return;
      }

      let z_max = puntos.reduce((a, b) => a.z > b.z ? a : b);

      let trace = {
        x: puntos.map(p => p.x),
        y: puntos.map(p => p.y),
        mode: 'markers',
        type: 'scatter',
        name: 'Región factible',
        marker: { color: 'lightblue', size: 5 }
      };

      let optimo = {
        x: [z_max.x],
        y: [z_max.y],
        mode: 'markers+text',
        type: 'scatter',
        name: 'Solución óptima',
        text: [`Z máx: ${z_max.z.toFixed(2)}`],
        textposition: 'top center',
        marker: { color: 'red', size: 10 }
      };

      let layout = {
        title: 'Gráfico del modelo',
        xaxis: { title: 'x', range: [0, 20] },
        yaxis: { title: 'y', range: [0, 20] }
      };

      Plotly.newPlot('grafica', [trace, optimo], layout);
    }
  </script>

</body>
</html>
